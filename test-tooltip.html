<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>HeroUI Tooltip Test</title>
    <script src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        /* Include our tooltip animations */
        @keyframes tooltip-scale-enter {
          from { opacity: 0; transform: scale(0.9); }
          to { opacity: 1; transform: scale(1); }
        }
        .tooltip-scale-enter {
          animation: tooltip-scale-enter 200ms cubic-bezier(0.16, 1, 0.3, 1);
        }
        
        /* HeroUI Colors */
        .bg-content1 { background-color: #ffffff; }
        .text-content1-foreground { color: #11181c; }
        .border-divider { border-color: #e4e4e7; }
        .bg-primary { background-color: #006fee; }
        .text-primary-foreground { color: #ffffff; }
        .bg-success { background-color: #17c964; }
        .text-success-foreground { color: #ffffff; }
        .bg-danger { background-color: #f31260; }
        .text-danger-foreground { color: #ffffff; }
        .text-small { font-size: 0.875rem; line-height: 1.25rem; }
        .rounded-medium { border-radius: 0.75rem; }
        .shadow-medium { box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06); }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useRef, useEffect, useCallback, useMemo, useId, isValidElement, cloneElement, forwardRef } = React;
        const { createPortal } = ReactDOM;
        
        // Simple Button component for testing
        const Button = ({ children, className = "", ...props }) => (
            <button 
                className={`px-4 py-2 bg-blue-500 text-white rounded hover:bg-blue-600 transition-colors ${className}`}
                {...props}
            >
                {children}
            </button>
        );

        // Our HeroUI-style Tooltip component (simplified for demo)
        const Tooltip = forwardRef(({
            children,
            content,
            placement = "top",
            color = "default",
            size = "md",
            showArrow = true,
            delay = 0,
            closeDelay = 500,
            isDisabled = false,
            isOpen,
            onOpenChange,
        }, ref) => {
            const [internalIsOpen, setInternalIsOpen] = useState(false);
            const [position, setPosition] = useState({ top: 0, left: 0 });
            
            const triggerRef = useRef(null);
            const tooltipRef = useRef(null);
            const delayTimeoutRef = useRef(null);
            const closeTimeoutRef = useRef(null);
            const tooltipId = useId();
            
            const isControlled = isOpen !== undefined;
            const tooltipIsOpen = isControlled ? isOpen : internalIsOpen;
            
            const colorClasses = {
                default: "bg-content1 text-content1-foreground border-divider",
                primary: "bg-primary text-primary-foreground border-primary/20",
                success: "bg-success text-success-foreground border-success/20",
                danger: "bg-danger text-danger-foreground border-danger/20",
            };
            
            const sizeClasses = {
                sm: "px-2 py-1 text-xs",
                md: "px-3 py-2 text-small",
                lg: "px-4 py-3 text-base",
            };
            
            const updatePosition = useCallback(() => {
                if (!triggerRef.current || !tooltipRef.current || !tooltipIsOpen) return;
                
                const triggerRect = triggerRef.current.getBoundingClientRect();
                const tooltipRect = tooltipRef.current.getBoundingClientRect();
                const scrollTop = window.pageYOffset || document.documentElement.scrollTop;
                const scrollLeft = window.pageXOffset || document.documentElement.scrollLeft;
                
                let top, left;
                
                switch (placement) {
                    case "top":
                        top = triggerRect.top + scrollTop - tooltipRect.height - 8;
                        left = triggerRect.left + scrollLeft + triggerRect.width / 2 - tooltipRect.width / 2;
                        break;
                    case "bottom":
                        top = triggerRect.bottom + scrollTop + 8;
                        left = triggerRect.left + scrollLeft + triggerRect.width / 2 - tooltipRect.width / 2;
                        break;
                    case "left":
                        top = triggerRect.top + scrollTop + triggerRect.height / 2 - tooltipRect.height / 2;
                        left = triggerRect.left + scrollLeft - tooltipRect.width - 8;
                        break;
                    case "right":
                        top = triggerRect.top + scrollTop + triggerRect.height / 2 - tooltipRect.height / 2;
                        left = triggerRect.right + scrollLeft + 8;
                        break;
                    default:
                        top = triggerRect.top + scrollTop - tooltipRect.height - 8;
                        left = triggerRect.left + scrollLeft + triggerRect.width / 2 - tooltipRect.width / 2;
                }
                
                setPosition({ top, left });
            }, [placement, tooltipIsOpen]);
            
            useEffect(() => {
                if (tooltipIsOpen) {
                    updatePosition();
                }
            }, [tooltipIsOpen, updatePosition]);
            
            const openTooltip = useCallback(() => {
                if (isDisabled) return;
                
                if (closeTimeoutRef.current) {
                    clearTimeout(closeTimeoutRef.current);
                    closeTimeoutRef.current = null;
                }
                
                delayTimeoutRef.current = setTimeout(() => {
                    if (!isControlled) {
                        setInternalIsOpen(true);
                    }
                    onOpenChange?.(true);
                }, delay);
            }, [isDisabled, isControlled, delay, onOpenChange]);
            
            const closeTooltip = useCallback(() => {
                if (isDisabled) return;
                
                if (delayTimeoutRef.current) {
                    clearTimeout(delayTimeoutRef.current);
                    delayTimeoutRef.current = null;
                }
                
                closeTimeoutRef.current = setTimeout(() => {
                    if (!isControlled) {
                        setInternalIsOpen(false);
                    }
                    onOpenChange?.(false);
                }, closeDelay);
            }, [isDisabled, isControlled, closeDelay, onOpenChange]);
            
            const renderTrigger = () => {
                if (!isValidElement(children)) {
                    return children;
                }
                
                const childProps = children.props;
                
                return cloneElement(children, {
                    ref: (node) => {
                        triggerRef.current = node;
                        if (ref) {
                            if (typeof ref === 'function') {
                                ref(node);
                            } else {
                                ref.current = node;
                            }
                        }
                    },
                    onMouseEnter: (e) => {
                        childProps.onMouseEnter?.(e);
                        openTooltip();
                    },
                    onMouseLeave: (e) => {
                        childProps.onMouseLeave?.(e);
                        closeTooltip();
                    },
                    'aria-describedby': tooltipIsOpen ? tooltipId : undefined,
                });
            };
            
            const getArrowStyles = () => {
                if (!showArrow) return null;
                
                const arrowSize = 8;
                const arrowColors = {
                    default: "#ffffff",
                    primary: "#006fee",
                    success: "#17c964",
                    danger: "#f31260",
                };
                
                const baseStyle = {
                    position: "absolute",
                    width: 0,
                    height: 0,
                    border: "solid transparent",
                };
                
                switch (placement) {
                    case "top":
                        return {
                            ...baseStyle,
                            top: "100%",
                            left: "50%",
                            transform: "translateX(-50%)",
                            borderLeftWidth: arrowSize,
                            borderRightWidth: arrowSize,
                            borderTopWidth: arrowSize,
                            borderTopColor: arrowColors[color],
                        };
                    case "bottom":
                        return {
                            ...baseStyle,
                            bottom: "100%",
                            left: "50%",
                            transform: "translateX(-50%)",
                            borderLeftWidth: arrowSize,
                            borderRightWidth: arrowSize,
                            borderBottomWidth: arrowSize,
                            borderBottomColor: arrowColors[color],
                        };
                    case "left":
                        return {
                            ...baseStyle,
                            left: "100%",
                            top: "50%",
                            transform: "translateY(-50%)",
                            borderTopWidth: arrowSize,
                            borderBottomWidth: arrowSize,
                            borderLeftWidth: arrowSize,
                            borderLeftColor: arrowColors[color],
                        };
                    case "right":
                        return {
                            ...baseStyle,
                            right: "100%",
                            top: "50%",
                            transform: "translateY(-50%)",
                            borderTopWidth: arrowSize,
                            borderBottomWidth: arrowSize,
                            borderRightWidth: arrowSize,
                            borderRightColor: arrowColors[color],
                        };
                    default:
                        return baseStyle;
                }
            };
            
            const tooltipElement = tooltipIsOpen ? (
                <div
                    ref={tooltipRef}
                    className={`
                        fixed z-50 border backdrop-blur-md tooltip-scale-enter
                        ${colorClasses[color]}
                        ${sizeClasses[size]}
                        rounded-medium shadow-medium
                    `}
                    style={{
                        top: position.top,
                        left: position.left,
                        zIndex: 50,
                    }}
                    role="tooltip"
                    id={tooltipId}
                >
                    {content}
                    {showArrow && getArrowStyles() && (
                        <div style={getArrowStyles()} />
                    )}
                </div>
            ) : null;
            
            return (
                <>
                    {renderTrigger()}
                    {tooltipElement && createPortal(tooltipElement, document.body)}
                </>
            );
        });
        
        // Test App
        const App = () => {
            const [isOpen, setIsOpen] = useState(false);
            
            return (
                <div className="min-h-screen bg-gray-50 p-8">
                    <div className="max-w-4xl mx-auto">
                        <h1 className="text-4xl font-bold text-gray-900 mb-8">HeroUI Tooltip Test</h1>
                        
                        <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8">
                            {/* Basic Tooltip */}
                            <div className="p-6 bg-white rounded-lg shadow text-center">
                                <h3 className="font-medium mb-4">Basic Tooltip</h3>
                                <Tooltip content="This is a basic tooltip">
                                    <Button>Hover me</Button>
                                </Tooltip>
                            </div>
                            
                            {/* Color Variants */}
                            <div className="p-6 bg-white rounded-lg shadow text-center">
                                <h3 className="font-medium mb-4">Primary Color</h3>
                                <Tooltip content="Primary colored tooltip" color="primary">
                                    <Button className="bg-blue-500 hover:bg-blue-600">Primary</Button>
                                </Tooltip>
                            </div>
                            
                            <div className="p-6 bg-white rounded-lg shadow text-center">
                                <h3 className="font-medium mb-4">Success Color</h3>
                                <Tooltip content="Success colored tooltip" color="success">
                                    <Button className="bg-green-500 hover:bg-green-600">Success</Button>
                                </Tooltip>
                            </div>
                            
                            {/* Placement */}
                            <div className="p-6 bg-white rounded-lg shadow text-center">
                                <h3 className="font-medium mb-4">Bottom Placement</h3>
                                <Tooltip content="Tooltip at bottom" placement="bottom">
                                    <Button>Bottom</Button>
                                </Tooltip>
                            </div>
                            
                            <div className="p-6 bg-white rounded-lg shadow text-center">
                                <h3 className="font-medium mb-4">Left Placement</h3>
                                <Tooltip content="Tooltip on left" placement="left">
                                    <Button>Left</Button>
                                </Tooltip>
                            </div>
                            
                            <div className="p-6 bg-white rounded-lg shadow text-center">
                                <h3 className="font-medium mb-4">Right Placement</h3>
                                <Tooltip content="Tooltip on right" placement="right">
                                    <Button>Right</Button>
                                </Tooltip>
                            </div>
                            
                            {/* Controlled */}
                            <div className="p-6 bg-white rounded-lg shadow text-center">
                                <h3 className="font-medium mb-4">Controlled</h3>
                                <div className="space-y-3">
                                    <Tooltip 
                                        content="Controlled tooltip" 
                                        isOpen={isOpen}
                                        onOpenChange={setIsOpen}
                                    >
                                        <Button>Controlled</Button>
                                    </Tooltip>
                                    <Button 
                                        onClick={() => setIsOpen(!isOpen)}
                                        className="w-full bg-gray-500 hover:bg-gray-600"
                                    >
                                        Toggle
                                    </Button>
                                </div>
                            </div>
                            
                            {/* No Arrow */}
                            <div className="p-6 bg-white rounded-lg shadow text-center">
                                <h3 className="font-medium mb-4">No Arrow</h3>
                                <Tooltip content="Tooltip without arrow" showArrow={false}>
                                    <Button>No Arrow</Button>
                                </Tooltip>
                            </div>
                            
                            {/* Delayed */}
                            <div className="p-6 bg-white rounded-lg shadow text-center">
                                <h3 className="font-medium mb-4">Delayed</h3>
                                <Tooltip content="Delayed tooltip (1s)" delay={1000}>
                                    <Button>Delayed</Button>
                                </Tooltip>
                            </div>
                        </div>
                        
                        <div className="mt-12 p-6 bg-white rounded-lg shadow">
                            <h2 className="text-2xl font-semibold mb-4">✅ HeroUI Features Implemented</h2>
                            <div className="grid grid-cols-1 md:grid-cols-2 gap-4 text-sm">
                                <div>
                                    <strong>Core API:</strong>
                                    <ul className="list-disc ml-5 mt-2 space-y-1">
                                        <li>✅ HeroUI-style props</li>
                                        <li>✅ Color variants</li>
                                        <li>✅ Size variants</li>
                                        <li>✅ Placement options</li>
                                        <li>✅ Arrow support</li>
                                        <li>✅ Controlled state</li>
                                    </ul>
                                </div>
                                <div>
                                    <strong>Advanced Features:</strong>
                                    <ul className="list-disc ml-5 mt-2 space-y-1">
                                        <li>✅ Smart positioning</li>
                                        <li>✅ Smooth animations</li>
                                        <li>✅ Portal rendering</li>
                                        <li>✅ Ref forwarding</li>
                                        <li>✅ Event handling</li>
                                        <li>✅ TypeScript support</li>
                                    </ul>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            );
        };
        
        ReactDOM.render(<App />, document.getElementById('root'));
    </script>
</body>
</html>
